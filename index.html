<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Bubble Dash v1.2 Manual</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      text-align: center;
      margin: 0;
      padding: 20px;
    }
    #game-container {
      position: relative;
      margin: 0 auto;
      width: 620px;
      background: #fff;
      padding: 20px;
      border: 2px solid #ccc;
      border-radius: 10px;
      overflow: hidden;
    }
    canvas {
      background: #e0f7fa;
      border: 1px solid #000;
      display: block;
      margin: 10px auto;
    }
    /* Overlay Demo */
    #overlay, 
    /* Overlay Manual */
    #manual-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      color: #fff;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 20px;
      box-sizing: border-box;
      z-index: 10;
    }
    #overlay h2, #manual-overlay h2 {
      margin-bottom: 20px;
    }
    #overlay p, #manual-overlay p {
      text-align: left;
      max-width: 550px;
      line-height: 1.6;
    }
    #start-btn, #manual-close-btn, #manual-btn {
      margin-top: 30px;
      padding: 10px 20px;
      font-size: 18px;
      cursor: pointer;
      border: none;
      border-radius: 5px;
      background: #4caf50;
      color: #fff;
    }
    /* Tombol Manual di header game */
    #manual-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #2196f3;
    }
  </style>
</head>
<body>
  <div id="game-container">
    <!-- Overlay Demo -->
    <div id="overlay">
      <h2>ğŸŒŸ Selamat datang di Bubble Dash v1.2! ğŸŒŸ</h2>
      <p>
        ğŸ’¥ Gelembung warna-warni berterbangan di sekitarmu!<br>
        ğŸ’¡ Tugasmu sederhana: Klik gelembung yang warnanya cocok dengan target sebelum waktu habis.<br><br>
        â³ Kamu punya 60 detik untuk mengumpulkan poin sebanyak mungkin!<br>
        ğŸ˜ƒ Kini hadir bonus bubble (gelembung emas dengan bintang â­) yang memberikan 50 poin jika diklik, serta efek suara saat gelembung meletus!<br><br>
        ğŸ”” Tips:<br>
        âœ… Jangan klik gelembung yang salah, itu hanya membuang waktu!<br>
        âœ… Gunakan kecepatan dan fokusmu untuk mencetak skor tertinggi!<br>
        âœ… Warna target akan berubah setiap beberapa detik, jadi tetap waspada!<br><br>
        ğŸ“¢ Siap untuk tantangan ini?<br>
        Tekan <strong>Mulai</strong> dan lihat seberapa cepat reaksimu!
      </p>
      <button id="start-btn">Mulai</button>
    </div>

    <!-- Overlay Manual (tersembunyi secara default) -->
    <div id="manual-overlay" style="display:none;">
      <h2>Petunjuk Game (Manual)</h2>
      <p>
        <strong>Kontrol Game:</strong><br>
        â€¢ Klik gelembung dengan warna target untuk mendapatkan 10 poin.<br>
        â€¢ Jika mengklik gelembung bonus (berwarna emas dengan â­), dapatkan 50 poin.<br>
        â€¢ Perhatikan waktu yang tersisa, kamu hanya memiliki 60 detik.<br><br>
        <strong>Tips:</strong><br>
        â€¢ Jangan klik gelembung yang tidak sesuai dengan warna target.<br>
        â€¢ Warna target akan berubah setiap 5 detik, jadi tetap awasi layar!<br>
        â€¢ Manfaatkan bonus bubble untuk menambah skor dengan cepat.
      </p>
      <button id="manual-close-btn">Tutup Petunjuk</button>
    </div>

    <!-- Tombol untuk membuka petunjuk manual -->
    <button id="manual-btn">Manual</button>

    <h1>Bubble Dash v1.2</h1>
    <p>Target Color: <span id="targetColor"></span></p>
    <p>Time: <span id="timer">60</span> detik</p>
    <p>Score: <span id="score">0</span></p>
    <canvas id="gameCanvas" width="600" height="400"></canvas>
  </div>

  <script>
    // Inisialisasi canvas dan variabel game
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");

    let bubbles = [];
    let score = 0;
    let timeLeft = 60; // durasi permainan dalam detik
    let targetColor = "";
    const colors = ["red", "blue", "green", "yellow", "purple", "orange"];
    const emoticons = ["ğŸ˜€", "ğŸ˜ƒ", "ğŸ˜„", "ğŸ˜", "ğŸ˜†", "ğŸ˜‚", "ğŸ˜Š", "ğŸ˜"];

    const targetColorDisplay = document.getElementById("targetColor");
    const timerDisplay = document.getElementById("timer");
    const scoreDisplay = document.getElementById("score");
    const overlay = document.getElementById("overlay");
    const startBtn = document.getElementById("start-btn");
    const manualOverlay = document.getElementById("manual-overlay");
    const manualBtn = document.getElementById("manual-btn");
    const manualCloseBtn = document.getElementById("manual-close-btn");

    // Variabel untuk audio efek pop
    let popSound = new Audio("pop.mp3");

    // Variabel untuk bubble spawn rate
    let bubbleSpawnInterval = 800; // milidetik

    let timerInterval, targetInterval;

    // Fungsi untuk menentukan warna target secara acak
    function setTargetColor() {
      targetColor = colors[Math.floor(Math.random() * colors.length)];
      targetColorDisplay.textContent = targetColor;
      targetColorDisplay.style.color = targetColor;
    }

    // Fungsi untuk membuat gelembung baru (dengan bonus bubble)
    function createBubble() {
      const radius = Math.random() * 20 + 20; // radius antara 20 dan 40
      const x = Math.random() * (canvas.width - 2 * radius) + radius;
      const y = Math.random() * (canvas.height - 2 * radius) + radius;
      let color, emot, isBonus = false;
      
      if (Math.random() < 0.1) { // 10% peluang muncul bonus bubble
        isBonus = true;
        color = "gold";
        emot = "â­";
      } else {
        color = colors[Math.floor(Math.random() * colors.length)];
        emot = emoticons[Math.floor(Math.random() * emoticons.length)];
      }
      bubbles.push({ x, y, radius, color, emot, isBonus });
    }

    // Fungsi untuk menggambar gelembung di canvas
    function drawBubbles() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      bubbles.forEach(bubble => {
        ctx.beginPath();
        ctx.arc(bubble.x, bubble.y, bubble.radius, 0, Math.PI * 2);
        ctx.fillStyle = bubble.color;
        ctx.fill();
        ctx.strokeStyle = bubble.isBonus ? "darkorange" : "#fff";
        ctx.lineWidth = bubble.isBonus ? 3 : 1;
        ctx.stroke();

        // Gambar emotikon di tengah gelembung
        ctx.fillStyle = "#000";
        ctx.font = `${bubble.radius}px Arial`;
        ctx.textAlign = "center";
        ctx.textBaseline = "middle";
        ctx.fillText(bubble.emot, bubble.x, bubble.y);
      });
    }

    // Spawn bubble secara rekursif dengan interval dinamis
    function spawnBubble() {
      createBubble();
      setTimeout(spawnBubble, bubbleSpawnInterval);
    }

    // Event listener untuk klik pada canvas
    canvas.addEventListener("click", function(event) {
      const rect = canvas.getBoundingClientRect();
      const clickX = event.clientX - rect.left;
      const clickY = event.clientY - rect.top;
      
      for (let i = 0; i < bubbles.length; i++) {
        const bubble = bubbles[i];
        const distance = Math.sqrt((clickX - bubble.x) ** 2 + (clickY - bubble.y) ** 2);
        if (distance < bubble.radius) {
          popSound.currentTime = 0;
          if (bubble.isBonus) {
            score += 50;
            popSound.play();
            bubbles.splice(i, 1);
            scoreDisplay.textContent = score;
            break;
          }
          if (bubble.color === targetColor) {
            score += 10;
            popSound.play();
            bubbles.splice(i, 1);
            scoreDisplay.textContent = score;
            break;
          }
        }
      }
    });

    // Game loop
    function update() {
      drawBubbles();
      requestAnimationFrame(update);
    }

    // Fungsi untuk memulai game
    function startGame() {
      overlay.style.display = "none";
      setTargetColor();
      update();

      timerInterval = setInterval(() => {
        timeLeft--;
        timerDisplay.textContent = timeLeft;
        if (timeLeft <= 0) {
          clearInterval(timerInterval);
          clearInterval(targetInterval);
          alert("Waktu habis! Skor kamu: " + score);
          window.location.reload();
        }
      }, 1000);

      targetInterval = setInterval(setTargetColor, 5000);
      spawnBubble();
      setInterval(() => {
        if (bubbleSpawnInterval > 400) {
          bubbleSpawnInterval -= 50;
        }
      }, 10000);
    }

    // Event listener tombol Mulai
    startBtn.addEventListener("click", startGame);

    // Tombol Manual untuk membuka petunjuk
    manualBtn.addEventListener("click", () => {
      manualOverlay.style.display = "flex";
    });
    // Tombol untuk menutup petunjuk manual
    manualCloseBtn.addEventListener("click", () => {
      manualOverlay.style.display = "none";
    });
  </script>
</body>
</html>
